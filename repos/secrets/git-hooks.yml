# Secret Detection
- id: repo-scan-gitleaks
  name: Checks commits for secrets w gitleaks
  description: Checks commits for secrets w gitleaks
  entry: zricethezav/gitleaks
  args: ["--verbose", "--pretty"]
  pass_filenames: false
  language: docker_image
  verbose: true

- id: repo-scan-detect-secrets
  name: Detect secrets
  description: Detects high entropy strings that are likely to be passwords.
  entry: --entrypoint detect-secrets donaldrich/function:detect-secrets
  args: ["scan", "--base64-limit", "4.5", "--hex-limit", "3"]
  # args: [--baseline, ci/secrets.baseline]
  language: docker_image
  # for backward compatibility
  # files: .*
